{"ast":null,"code":"import _classCallCheck from\"/Users/Signe/Documents/work-folder/CODING/BrainStation/Capstone/asgard-scan/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Signe/Documents/work-folder/CODING/BrainStation/Capstone/asgard-scan/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/Signe/Documents/work-folder/CODING/BrainStation/Capstone/asgard-scan/client/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Signe/Documents/work-folder/CODING/BrainStation/Capstone/asgard-scan/client/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import NoSensitivity from\"../../components/NoSensitivity/index\";import YesSensitivity from\"../../components/YesSensitivity/YesSensitivity\";import ProductList from\"../../components/ProductList/ProductList\";import IngredientList from\"../../components/IngredientList/IngredientList\";import Footer from\"../../components/Footer/index\";import Alert from\"../../assets/logo/alert-icon.svg\";import{getProducts,getSingleUser,addNotSensitiveProduct,addSensitiveToProduct,deleteProductSensitiveTo}from\"../../utils/dataUtils\";import\"./HomePage.scss\";import Modal from\"react-modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";Modal.setAppElement(\"#root\");var HomePage=/*#__PURE__*/function(_Component){_inherits(HomePage,_Component);var _super=_createSuper(HomePage);function HomePage(){var _this;_classCallCheck(this,HomePage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={userID:null,username:_this.props.username,token:null,products:null,displayProducts:null,noSensitivity:null,yesSensitivity:null,currentUser:null,sensitiveToIngredients:null,item:null,ingredientSearch:[],isActive:false,deletedItem:[],modal:false};_this.closeModal=function(){return _this.setState({modal:false});};_this.toggleModal=function(item){_this.setState({modal:!_this.state.modal,deletedItem:item});};_this.deleteItem=function(){var deletedProduct=_this.state.yesSensitivity.find(function(product){return product.productName===_this.state.deletedItem.productName;});console.log(deletedProduct.id);deleteProductSensitiveTo(deletedProduct.id).then(function(res){console.log(res.data);// TODO add logic to only remove the deleted Item from yesSensitivity list\nif(res.status===200){console.log(\"The Response status was 200!\");// this.setState({\n//   yesSensitivity: res.data,\n// });\n}}).catch(function(error){console.log(error);});};_this.deleteItemFunc=function(){_this.closeModal();_this.deleteItem();};_this.getSensitivityIngredients=function(user){var yesIngredients=user.noSensitivity.map(function(item){return item.ingredients.toLowerCase();});var notSensitiveToArray=yesIngredients.toString().split(\",\");var noIngredients=user.yesSensitivity.map(function(item){return item.ingredients.toLowerCase();});var sensitiveToArray=noIngredients.toString().split(\",\");var ingredientSensitivity=sensitiveToArray.filter(function(ingredient){return!notSensitiveToArray.includes(ingredient);});_this.setState({sensitiveToIngredients:ingredientSensitivity});};_this.upDateNotSesitiveTo=function(res){var yesIngredients=_this.state.noSensitivity.map(function(item){return item.ingredients.toLowerCase();});var notSensitiveToArray=yesIngredients.toString().split(\",\");var noIngredients=_this.state.yesSensitivity.map(function(item){return item.ingredients.toLowerCase();});var sensitiveToArray=noIngredients.toString().split(\",\");var ingredientSensitivity=sensitiveToArray.filter(function(ingredient){return!notSensitiveToArray.includes(ingredient);});_this.setState({sensitiveToIngredients:ingredientSensitivity});};_this.addProductSensitivity=function(product){_this.setState({item:product,isActive:!_this.state.isActive});console.log(\"I'm sensitive to this product:\",product);addSensitiveToProduct(_this.state.username,product).then(function(res){//add the products selected and send the ingredients to upDateNotSensitiveTo\nvar addProduct=_this.state.yesSensitivity;if(res.status!==200){return;}else if(!_this.state.yesSensitivity.find(function(product){return product.id===res.data.id;})){addProduct.push(res.data);}else{return;}console.log(addProduct);_this.setState({yesSensitivity:addProduct});_this.upDateNotSesitiveTo();}).catch(function(error){console.log(\"product did not add\",error);});console.log(_this.state.yesSensitivity);};_this.addProductNoSensitivity=function(e,product){e.preventDefault();console.log(e);//TODO fix this: Already created logic to remove button but it removes all buttons not just the product that has been added\n// this.setState({ item: product, isActive: !this.state.isActive });\nconsole.log(\"I'm not sensitive to this product:\",product);addNotSensitiveProduct(_this.state.username,product).then(function(res){var addProduct=_this.state.noSensitivity;if(res.status!==200){return;}else if(!_this.state.noSensitivity.find(function(product){return product.id===res.data.id;})){addProduct.push(res.data);}else{return;}_this.setState({noSensitivity:addProduct});_this.upDateNotSesitiveTo();}).catch(function(error){console.log(\"product did not add\",error);});};_this.handleOnChange=function(event){event.preventDefault();console.log(event.target.value);var searchIngredients=event.target.value.toLowerCase();console.log(searchIngredients);var searchArr=searchIngredients.split(\",\");console.log(searchIngredients);console.log(searchArr);_this.setState({displayProducts:_this.state.products.filter(function(product){return!product.ingredients.toLowerCase().includes(searchIngredients);})});console.log(_this.state.displayProducts);};_this.logout=function(){//Remove the item/token: i.e sesstionStorage.removeItem() once user log out\nsessionStorage.removeItem(\"token\");sessionStorage.removeItem(\"username\");_this.props.history.push(\"/login\");console.log(_this.props.history);};return _this;}_createClass(HomePage,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var username=sessionStorage.getItem(\"username\");console.log(username);this.setState({token:sessionStorage.getItem(\"token\")});getProducts().then(function(res){_this2.setState({products:res.data});return getSingleUser(username);// return getSingleUser(username, this.state.token);\n}).then(function(response){console.log(response.data);var user=response.data;_this2.setState({userID:user.id,username:user.username,yesSensitivity:user.yesSensitivity,noSensitivity:user.noSensitivity});_this2.getSensitivityIngredients(user);}).catch(function(error){console.log(\"error in componentDIdMount\",error);});}// Function for closing the modal.\n},{key:\"render\",value:function render(){return this.state.products&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IngredientList,{sensitiveToIngredients:this.state.sensitiveToIngredients}),/*#__PURE__*/_jsxs(\"main\",{className:\"main\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"main__heading\",children:\"Already know what you're sensitive to?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"main__search\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"main__copy\",children:[\" \",\"Type in the ingredient names that you're sensitive to seperated by a comma and click on \",/*#__PURE__*/_jsx(\"em\",{children:\"see more\"}),\" to find out which products don't contain them!\",/*#__PURE__*/_jsx(\"input\",{className:\"main__search--input\",type:\"text\",placeholder:\"Lauryl Laurate, Tocopheryl Acetate,...\",onChange:this.handleOnChange})]}),/*#__PURE__*/_jsx(ProductList,{displayProducts:this.state.displayProducts}),/*#__PURE__*/_jsx(\"h2\",{className:\"main__heading\",children:\"AM I SENSITIVE?\"}),/*#__PURE__*/_jsx(\"p\",{className:\"main__copy\",children:\"Add at least one product that you have used and do NOT have sensitivity towards\"}),/*#__PURE__*/_jsx(NoSensitivity,{products:this.state.products,addProductNoSensitivity:this.addProductNoSensitivity,isActive:this.state.isActive}),/*#__PURE__*/_jsxs(\"p\",{className:\"main__copy\",children:[\" \",\"Add products that you've had a negative reaction to below\"]}),/*#__PURE__*/_jsx(YesSensitivity,{addProductSensitivity:this.addProductSensitivity,isActive:this.state.isActive,products:this.state.products,toggleModal:this.toggleModal})]}),/*#__PURE__*/_jsxs(Modal,{isOpen:this.state.modal===true,className:\"modal__modal\",overlayClassName:\"modal__overlay\",transparent:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal__modal-top\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"modal__modal-item\",children:[\"Delete \",this.state.deletedItem.productName,\" from your sensitive list?\"]}),/*#__PURE__*/_jsx(\"img\",{onClick:this.closeModal,className:\"modal__modal-close\",src:Alert,alt:\"Close Icon\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"modal__modal-description\",children:[\"Please confirm that you'd like to delete\",\" \",this.state.deletedItem.productName,\" from your Sensitive To list.\"]}),/*#__PURE__*/_jsx(\"img\",{className:\"modal__modal-image\",src:this.state.deletedItem.image,alt:\"delete item from your yes sensitivity list\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal__modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:this.closeModal,className:\"modal__modal-cancel\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.deleteItemFunc,className:\"modal__modal-confirm\",children:\"Delete\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"main__btn-grad\",type:\"button\",onClick:this.logout,children:\"Log out\"})]}),/*#__PURE__*/_jsx(Footer,{})]});}}]);return HomePage;}(Component);export{HomePage as default};","map":{"version":3,"sources":["/Users/Signe/Documents/work-folder/CODING/BrainStation/Capstone/asgard-scan/client/src/pages/HomePage/HomePage.js"],"names":["React","Component","NoSensitivity","YesSensitivity","ProductList","IngredientList","Footer","getProducts","getSingleUser","addNotSensitiveProduct","addSensitiveToProduct","deleteProductSensitiveTo","Modal","setAppElement","HomePage","state","userID","username","props","token","products","displayProducts","noSensitivity","yesSensitivity","currentUser","sensitiveToIngredients","item","ingredientSearch","isActive","deletedItem","modal","closeModal","setState","toggleModal","deleteItem","deletedProduct","find","product","productName","console","log","id","then","res","data","status","catch","error","deleteItemFunc","getSensitivityIngredients","user","yesIngredients","map","ingredients","toLowerCase","notSensitiveToArray","toString","split","noIngredients","sensitiveToArray","ingredientSensitivity","filter","ingredient","includes","upDateNotSesitiveTo","addProductSensitivity","addProduct","push","addProductNoSensitivity","e","preventDefault","handleOnChange","event","target","value","searchIngredients","searchArr","logout","sessionStorage","removeItem","history","getItem","response","Alert","image"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport NoSensitivity from \"../../components/NoSensitivity/index\";\nimport YesSensitivity from \"../../components/YesSensitivity/YesSensitivity\";\nimport ProductList from \"../../components/ProductList/ProductList\";\nimport IngredientList from \"../../components/IngredientList/IngredientList\";\nimport Footer from \"../../components/Footer/index\";\nimport Alert from \"../../assets/logo/alert-icon.svg\";\nimport {\n  getProducts,\n  getSingleUser,\n  addNotSensitiveProduct,\n  addSensitiveToProduct,\n  deleteProductSensitiveTo,\n} from \"../../utils/dataUtils\";\nimport \"./HomePage.scss\";\nimport Modal from \"react-modal\";\n\nModal.setAppElement(\"#root\");\n\nexport default class HomePage extends Component {\n  state = {\n    userID: null,\n    username: this.props.username,\n    token: null,\n    products: null,\n    displayProducts: null,\n    noSensitivity: null,\n    yesSensitivity: null,\n    currentUser: null,\n    sensitiveToIngredients: null,\n    item: null,\n    ingredientSearch: [],\n    isActive: false,\n    deletedItem: [],\n    modal: false,\n  };\n\n  componentDidMount() {\n    const username = sessionStorage.getItem(\"username\");\n    console.log(username);\n    this.setState({ token: sessionStorage.getItem(\"token\") });\n    getProducts()\n      .then((res) => {\n        this.setState({\n          products: res.data,\n        });\n        return getSingleUser(username);\n        // return getSingleUser(username, this.state.token);\n      })\n      .then((response) => {\n        console.log(response.data);\n        const user = response.data;\n        this.setState({\n          userID: user.id,\n          username: user.username,\n          yesSensitivity: user.yesSensitivity,\n          noSensitivity: user.noSensitivity,\n        });\n        this.getSensitivityIngredients(user);\n      })\n      .catch((error) => {\n        console.log(\"error in componentDIdMount\", error);\n      });\n  }\n\n  // Function for closing the modal.\n  closeModal = () => this.setState({ modal: false });\n\n  //Open Modal\n  toggleModal = (item) => {\n    this.setState({\n      modal: !this.state.modal,\n      deletedItem: item,\n    });\n  };\n  deleteItem = () => {\n    let deletedProduct = this.state.yesSensitivity.find(\n      (product) => product.productName === this.state.deletedItem.productName\n    );\n    console.log(deletedProduct.id);\n    deleteProductSensitiveTo(deletedProduct.id)\n      .then((res) => {\n        console.log(res.data);\n        // TODO add logic to only remove the deleted Item from yesSensitivity list\n        if (res.status === 200) {\n          console.log(\"The Response status was 200!\");\n\n          // this.setState({\n          //   yesSensitivity: res.data,\n\n          // });\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n  //close the modal/delete an item.\n\n  deleteItemFunc = () => {\n    this.closeModal();\n    this.deleteItem();\n  };\n\n  // //Find ingredients that the user is senstive to by comparing their no_sensitivity list to yes_sensitivity list\n  // and return ingredients not in the no_sensitivity list.\n  getSensitivityIngredients = (user) => {\n    let yesIngredients = user.noSensitivity.map((item) =>\n      item.ingredients.toLowerCase()\n    );\n    const notSensitiveToArray = yesIngredients.toString().split(\",\");\n    let noIngredients = user.yesSensitivity.map((item) =>\n      item.ingredients.toLowerCase()\n    );\n    const sensitiveToArray = noIngredients.toString().split(\",\");\n    const ingredientSensitivity = sensitiveToArray.filter(\n      (ingredient) => !notSensitiveToArray.includes(ingredient)\n    );\n\n    this.setState({\n      sensitiveToIngredients: ingredientSensitivity,\n    });\n  };\n\n  //update ingredient list once a product has been added to the no_sensitivitie list or yes_sensitivity list\n  upDateNotSesitiveTo = (res) => {\n    let yesIngredients = this.state.noSensitivity.map((item) =>\n      item.ingredients.toLowerCase()\n    );\n    const notSensitiveToArray = yesIngredients.toString().split(\",\");\n\n    let noIngredients = this.state.yesSensitivity.map((item) =>\n      item.ingredients.toLowerCase()\n    );\n    const sensitiveToArray = noIngredients.toString().split(\",\");\n\n    const ingredientSensitivity = sensitiveToArray.filter(\n      (ingredient) => !notSensitiveToArray.includes(ingredient)\n    );\n\n    this.setState({\n      sensitiveToIngredients: ingredientSensitivity,\n    });\n  };\n\n  //User adds products to their yesSensitive list\n  addProductSensitivity = (product) => {\n    this.setState({ item: product, isActive: !this.state.isActive });\n\n    console.log(\"I'm sensitive to this product:\", product);\n    addSensitiveToProduct(this.state.username, product)\n      .then((res) => {\n        //add the products selected and send the ingredients to upDateNotSensitiveTo\n        let addProduct = this.state.yesSensitivity;\n        if (res.status !== 200) {\n          return;\n        } else if (\n          !this.state.yesSensitivity.find(\n            (product) => product.id === res.data.id\n          )\n        ) {\n          addProduct.push(res.data);\n        } else {\n          return;\n        }\n\n        console.log(addProduct);\n        this.setState({ yesSensitivity: addProduct });\n        this.upDateNotSesitiveTo();\n      })\n      .catch((error) => {\n        console.log(\"product did not add\", error);\n      });\n    console.log(this.state.yesSensitivity);\n  };\n\n  //Add product that user is NOT sensitive to and it compares ingredient list to products user IS sensitive to\n  addProductNoSensitivity = (e, product) => {\n    e.preventDefault();\n    console.log(e);\n    //TODO fix this: Already created logic to remove button but it removes all buttons not just the product that has been added\n    // this.setState({ item: product, isActive: !this.state.isActive });\n    console.log(\"I'm not sensitive to this product:\", product);\n    addNotSensitiveProduct(this.state.username, product)\n      .then((res) => {\n        let addProduct = this.state.noSensitivity;\n        if (res.status !== 200) {\n          return;\n        } else if (\n          !this.state.noSensitivity.find(\n            (product) => product.id === res.data.id\n          )\n        ) {\n          addProduct.push(res.data);\n        } else {\n          return;\n        }\n\n        this.setState({ noSensitivity: addProduct });\n\n        this.upDateNotSesitiveTo();\n      })\n      .catch((error) => {\n        console.log(\"product did not add\", error);\n      });\n  };\n  //User types ingredents into the search bar: water, coconut oil, etc...  and returns products that do not contain those ingredients shown in the SEE MORE section\n  handleOnChange = (event) => {\n    event.preventDefault();\n    console.log(event.target.value);\n    const searchIngredients = event.target.value.toLowerCase();\n    console.log(searchIngredients);\n    const searchArr = searchIngredients.split(\",\");\n    console.log(searchIngredients);\n    console.log(searchArr);\n\n    this.setState({\n      displayProducts: this.state.products.filter((product) => {\n        return !product.ingredients.toLowerCase().includes(searchIngredients);\n      }),\n    });\n    console.log(this.state.displayProducts);\n  };\n\n  logout = () => {\n    //Remove the item/token: i.e sesstionStorage.removeItem() once user log out\n    sessionStorage.removeItem(\"token\");\n    sessionStorage.removeItem(\"username\");\n    this.props.history.push(\"/login\");\n    console.log(this.props.history);\n  };\n\n  render() {\n    return (\n      this.state.products && (\n        <>\n          <IngredientList\n            sensitiveToIngredients={this.state.sensitiveToIngredients}\n          />\n\n          <main className=\"main\">\n            <h2 className=\"main__heading\">\n              Already know what you're sensitive to?\n            </h2>\n            <div className=\"main__search\">\n              <label className=\"main__copy\">\n                {\" \"}\n                Type in the ingredient names that you're sensitive to seperated\n                by a comma and click on <em>see more</em> to find out which\n                products don't contain them!\n                <input\n                  className=\"main__search--input\"\n                  type=\"text\"\n                  placeholder=\"Lauryl Laurate, Tocopheryl Acetate,...\"\n                  onChange={this.handleOnChange}\n                />\n              </label>\n              <ProductList displayProducts={this.state.displayProducts} />\n              <h2 className=\"main__heading\">AM I SENSITIVE?</h2>\n\n              <p className=\"main__copy\">\n                Add at least one product that you have used and do NOT have\n                sensitivity towards\n              </p>\n              <NoSensitivity\n                products={this.state.products}\n                addProductNoSensitivity={this.addProductNoSensitivity}\n                isActive={this.state.isActive}\n              />\n\n              <p className=\"main__copy\">\n                {\" \"}\n                Add products that you've had a negative reaction to below\n              </p>\n              <YesSensitivity\n                addProductSensitivity={this.addProductSensitivity}\n                isActive={this.state.isActive}\n                products={this.state.products}\n                toggleModal={this.toggleModal}\n              />\n            </div>\n            {/* ///TODO Debugging delete function with Modal below */}\n            <Modal\n              isOpen={this.state.modal === true}\n              className=\"modal__modal\"\n              overlayClassName=\"modal__overlay\"\n              transparent={true}\n            >\n              <div className=\"modal__modal-top\">\n                <h1 className=\"modal__modal-item\">\n                  Delete {this.state.deletedItem.productName} from your\n                  sensitive list?\n                </h1>\n                <img\n                  onClick={this.closeModal}\n                  className=\"modal__modal-close\"\n                  src={Alert}\n                  alt=\"Close Icon\"\n                />\n              </div>\n              <div>\n                <p className=\"modal__modal-description\">\n                  Please confirm that you'd like to delete{\" \"}\n                  {this.state.deletedItem.productName} from your Sensitive To\n                  list.\n                </p>\n                <img\n                  className=\"modal__modal-image\"\n                  src={this.state.deletedItem.image}\n                  alt=\"delete item from your yes sensitivity list\"\n                />\n              </div>\n              <div className=\"modal__modal-buttons\">\n                <button\n                  onClick={this.closeModal}\n                  className=\"modal__modal-cancel\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={this.deleteItemFunc}\n                  className=\"modal__modal-confirm\"\n                >\n                  Delete\n                </button>\n              </div>\n            </Modal>\n            <button\n              className=\"main__btn-grad\"\n              type=\"button\"\n              onClick={this.logout}\n            >\n              Log out\n            </button>\n          </main>\n          <Footer />\n        </>\n      )\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}